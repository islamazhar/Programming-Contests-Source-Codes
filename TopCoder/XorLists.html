<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
Given a sequence of n integers, we can compute the bitwise xor of each pair of integers.
This will give us a list of n^2 integers.
Your goal in this task is to reverse this process:
you will be given the list of n^2 integers and you have to count all sequences of length n that would produce it.
</p>

<p>
Formally, you are given a vector &lt;int&gt; <b>s</b> with n^2 elements.
We are now interested in sequences with the following properties:
<ul>
<li>The sequence has n elements.</li>
<li>Each element is an integer between 0 and <b>m</b>, inclusive.</li>
<li>If we denote the elements a[0], ..., a[n-1], then for each i and j between 0 and n-1, inclusive, <b>s</b>[i*n+j] equals (a[i] xor a[j]).</li>
</ul>
</p>

<p>
Count all such sequences and return their count modulo 1,000,000,007.
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>XorLists</td></tr><tr><td>Method:</td><td>countLists</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int countLists(vector &lt;int&gt; s, int m)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>n will be between 1 and 10, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>s</b> will have exactly n*n elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>s</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>m</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0}</pre></td></tr><tr><td><pre>10000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 10001</pre></td></tr><tr><td><table><tr><td colspan="2">Here, the unknown sequence has just a single element.
Regardless of its value, if we xor it with itself, it will produce a zero.
Hence, there are 10001 valid sequences: (0), (1), ..., and (10000).</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1}</pre></td></tr><tr><td><pre>10000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">The bitwise xor of a number with itself will never be 1, so there are no valid sequences.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,
 1,0,3,
 2,3,0}</pre></td></tr><tr><td><pre>5</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,3,
 3,0}</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">Note that even though the numbers in the lists are constrainted from 0 to 2, the XORs can be bigger than m and still have a solution.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{
0,18955782,19774078,15197314,10559559,9167552,1059865,10395923,23165910,45583720,
18955782,0,820344,29809284,25173569,27974854,19993119,29335317,4212176,60207982,
19774078,820344,0,30039804,25991737,27678910,20813415,28515181,5030312,60438294,
15197314,29809284,30039804,0,4637893,7079490,16238747,7947665,25599828,38824426,
10559559,25173569,25991737,4637893,0,2802311,11603038,4161876,29383569,35040559,
9167552,27974854,27678910,7079490,2802311,0,10211033,1393619,32151830,37515176,
1059865,19993119,20813415,16238747,11603038,10211033,0,9342218,24205263,44540273,
10395923,29335317,28515181,7947665,4161876,1393619,9342218,0,33544901,36252795,
23165910,4212176,5030312,25599828,29383569,32151830,24205263,33544901,0,64419518,
45583720,60207982,60438294,38824426,35040559,37515176,44540273,36252795,64419518,0
}</pre></td></tr><tr><td><pre>1000000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 976248323</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
